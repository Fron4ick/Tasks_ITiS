<!-- 3D_drum_navigation.html
     Единственный файл: положите в корень сайта и создайте папки с index.html внутри,
     например: /tabl_shtat/index.html

     Как использовать: откройте файл в браузере (Chrome/Edge/Firefox). Настройте массив
     `items` в <script> — каждая запись: {title, href, color}.
-->

<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>3D барабан навигации</title>
<style>
  :root{--size:420px;--panel-w:220px;--panel-h:120px}
  html,body{height:100%;margin:0;font-family:Inter,Segoe UI,Roboto,Arial,sans-serif;background:#0f1115;color:#eee}
  .wrap{height:100%;display:flex;align-items:center;justify-content:center;gap:24px;flex-direction:column}
  .scene{width:var(--size);height:var(--size);perspective:1200px}
  .drum{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform 800ms cubic-bezier(.2,.8,.2,1)}
  .panel{
    position:absolute;left:50%;top:50%;width:var(--panel-w);height:var(--panel-h);
    margin-left:calc(-1 * var(--panel-w) / 2);margin-top:calc(-1 * var(--panel-h) / 2);
    display:flex;align-items:center;justify-content:center;border-radius:12px;box-shadow:0 12px 30px rgba(0,0,0,.6);
    backface-visibility:hidden;cursor:pointer;user-select:none;transition:transform 240ms ease,box-shadow 240ms ease,filter 240ms ease;
    text-decoration:none;color:inherit;font-weight:600;font-size:18px;padding:12px;white-space:nowrap
  }
  .panel:hover{transform:translateZ(36px) scale(1.03);box-shadow:0 20px 40px rgba(0,0,0,.7);filter:brightness(1.02)}
  .controls{display:flex;gap:8px}
  .btn{background:#111214;border:1px solid rgba(255,255,255,.06);color:#fff;padding:10px 14px;border-radius:10px;cursor:pointer}
  .btn:active{transform:translateY(1px)}
  .legend{color:rgba(255,255,255,.65);font-size:14px}
  /* small screens */
  @media (max-width:520px){:root{--size:320px;--panel-w:180px;--panel-h:100px}}
</style>
</head>
<body>
<div class="wrap">
  <div class="scene" aria-hidden="false">
    <div id="drum" class="drum" role="list"></div>
  </div>
  <div style="display:flex;align-items:center;gap:12px">
    <div class="controls">
      <button id="prev" class="btn" aria-label="Предыдущая">◀</button>
      <button id="next" class="btn" aria-label="Следующая">▶</button>
    </div>
    <div class="legend">Используйте стрелки, свайп или кликайте на панель для перехода</div>
  </div>
</div>

<script>
/* ======= Конфигурация: добавьте/уберите элементы =======
   href — путь к index.html в нужной папке.
   title — текст на панели.
   color — фон панели (можно убрать).
*/
const items = [
  {title: 'Таблицы штатs', href: './tabl_shtat/index.html', color:'#136f63'},
  {title: 'Task 1.2', href: './task_1_2/index_validation.html', color:'#7b2ff7'}
];

const drum = document.getElementById('drum');
let rotationY = 0;
let index = 0;
const n = items.length;
const radius = Math.max(140, (parseInt(getComputedStyle(document.documentElement).getPropertyValue('--size'))/2));

function makePanel(item, i){
  const a = document.createElement('a');
  a.className = 'panel';
  a.setAttribute('role','listitem');
  a.href = item.href || '#';
  a.target = '_self';
  a.innerHTML = item.title;
  if(item.color) a.style.background = item.color;
  // position around Y axis
  const angle = (360 / n) * i;
  a.style.transform = `rotateY(${angle}deg) translateZ(${radius}px)`;
  a.dataset.angle = angle;
  // accessibility: describe
  a.setAttribute('aria-label', item.title + ' — открыть');
  // click -> follow
  a.addEventListener('click', e => {
    // normal navigation; keep default
  });
  drum.appendChild(a);
}

function render(){
  drum.innerHTML = '';
  for(let i=0;i<n;i++) makePanel(items[i], i);
  updateTransform();
}

function updateTransform(){
  drum.style.transform = `rotateY(${rotationY}deg)`;
}

function goTo(idx){
  index = ((idx % n) + n) % n;
  const anglePer = 360 / n;
  // rotate so that the chosen panel comes to front (0deg)
  rotationY = -index * anglePer;
  updateTransform();
}

// controls
document.getElementById('next').addEventListener('click', ()=> goTo(index+1));
document.getElementById('prev').addEventListener('click', ()=> goTo(index-1));

// keyboard
window.addEventListener('keydown', (e)=>{
  if(e.key === 'ArrowRight') goTo(index+1);
  if(e.key === 'ArrowLeft') goTo(index-1);
  if(e.key === 'Home') goTo(0);
  if(e.key === 'End') goTo(n-1);
});

// touch support: swipe left/right
let touchStartX = null;
window.addEventListener('touchstart', e => { if(e.touches && e.touches[0]) touchStartX = e.touches[0].clientX; });
window.addEventListener('touchend', e => {
  if(touchStartX === null) return;
  const endX = (e.changedTouches && e.changedTouches[0]) ? e.changedTouches[0].clientX : null;
  if(endX === null) return;
  const diff = endX - touchStartX;
  if(Math.abs(diff) > 30){ if(diff < 0) goTo(index+1); else goTo(index-1); }
  touchStartX = null;
});

// click on panel brings it to front first (then user can click again to follow)
// but we keep default navigation on click. To change: uncomment below to make first click bring front, second click navigate.
// let lastClicked = null;
// drum.addEventListener('click', e => {
//   const a = e.target.closest('.panel');
//   if(!a) return;
//   const ang = parseFloat(a.dataset.angle) || 0;
//   const anglePer = 360 / n;
//   const targetIndex = Math.round((360 - ang) / anglePer) % n;
//   if(targetIndex !== index){ e.preventDefault(); goTo(targetIndex); }
// });

// initial render
render();

// responsive re-calc radius on resize
window.addEventListener('resize', ()=>{
  const size = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--size')) || 420;
  // simple: keep radius ~ size/2 - panel depth
});
</script>
</body>
</html>
